---
title: 日替わり表の印刷
description: 翌日の製造および納品に必要な帳票類を一括で印刷する手順です。
---

import { Step, Steps } from 'fumadocs-ui/components/steps';
import { Callout } from 'fumadocs-ui/components/callout';
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';
import {
	FileText,
	CheckCircle,
	AlertTriangle,
	Printer,
	HelpCircle,
	FileSpreadsheet,
} from 'lucide-react';
import { Files, File, Folder } from 'fumadocs-ui/components/files';

# 🖨️ 日替わり表の印刷

翌日の製造および納品に必要な帳票類を一括で印刷します。
この作業は **午前 10:00 まで** に完了させてください。

<Callout title="使用するファイル" icon={<FileText />}>
    `CB商品データ.xlsm`を開いて作業します。

    <Files>
    	<Folder name='デスクトップ' defaultOpen>
    		<Folder name='よく使う' defaultOpen>
    			<Folder name='Backup'>
    				<File name='CB商品データYYYY-MM-DD更新後.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD更新前.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD〇〇店変更.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD更新後.xlsm' icon={<FileSpreadsheet />} />
    				...
    			</Folder>
    			<Folder name='商品データ' defaultOpen>
    				<Folder name='商品ごとの表'></Folder>
    				<File name='CB商品データ.xlsm' icon={<FileSpreadsheet />} />
    			</Folder>
    			<Folder name='伝票作成'>
    				<Folder name='納品記録'>
    					<Folder name='納品記録PDF'>
    						<Folder name='YYYY-MM'></Folder>
    						<Folder name='YYYY-MM'></Folder>
    					</Folder>
    				</Folder>
    				<File name='T納品データ.xlsm' icon={<FileSpreadsheet />} />
    			</Folder>
    		</Folder>
    	</Folder>
    </Files>

</Callout>
## 📋 操作手順

<Steps>
<Step>
 
### 準備（用紙の確認）

プリンターの電源が入っているか、A4 用紙が補充されているか確認してください。

<Callout type="info" title="用紙がない場合">
	もし予備の用紙がない場合は、**事務所**
	へ行き、補充用の用紙をもらってきてください。
</Callout>

</Step>
<Step>
 
### ファイルを開く

デスクトップの `よく使う` フォルダにある `CB商品データ.xlsm` を開きます。

**⚠️ コンテンツの有効化**

画面上部に「セキュリティの警告」という黄色いバーが出ている場合は、**「コンテンツの有効化」** をクリックしてください。これを行わないとボタンが反応しません。

</Step>
<Step>
 
### 日付の設定

「夜間用」シートを開き、画面上部にある **「明日」** ボタンをクリックします。
ボタンを押すと、各シートの日付が自動的に設定されます。

![日付ボタンの場所](https://placehold.co/600x400?text=Date+Button)

| シート名   | 日付設定       | 用途             |
| :--------- | :------------- | :--------------- |
| **夜間用** | **今日の日付** | 今夜の製造分     |
| **昼間用** | **翌日の日付** | 明日の日中製造分 |
| **その他** | **翌日の日付** | 納品・伝票用     |

<Callout type="tip" title="間違えて押してしまったら？">
	もし間違えて「明後日」などを押してしまっても大丈夫です。 再度、正しい
	**「明日」** ボタンを押し直せば、正しい日付に修正されます。
</Callout>

</Step>
<Step>
 
### 印刷の実行

シート上にある **「印刷」** ボタンをクリックします。
プリンターから帳票が出力されます。

![印刷ボタンの場所](https://placehold.co/600x400?text=Print+Button)

</Step>
<Step>
 
### 完了確認

出力された用紙を手に取り、以下の項目をチェックしてください。

- [ ] **枚数は足りていますか？**（通常 5 種類以上）
  1. 夜間用
  2. 昼間用
  3. 焼成後チェック表
  4. 伝票用（※複数枚の場合あり）
  5. クリエ伝票用
- [ ] **日付は正しいですか？**（伝票用が「翌日の日付」になっているか）
- [ ] **印刷は鮮明ですか？**（インク切れでかすれていないか）

<Callout type="warn" icon={<AlertTriangle />}>
	**枚数は変動します**

    店舗数や商品数が増えると、「伝票用」などの枚数は自動的に増えます。
    枚数ではなく、**「必要な種類の帳票がすべて揃っているか」**
    を確認してください。

</Callout>

</Step>
</Steps>

---

## ❓ トラブルシューティング

<Accordions>
	<Accordion title="ボタンを押しても何も起きない" icon={<HelpCircle />}>
		**原因:**\
		Excelのマクロが無効になっている可能性があります。 
        
        **対処法:**\
		画面の上部に「セキュリティの警告」という黄色い帯が出ていませんか？\
		出ている場合は **「コンテンツの有効化」** ボタンを押してください。

    </Accordion>
    <Accordion title="エラー画面が表示された" icon={<AlertTriangle />}>
    	**対処法:**
        1. エラー画面の **「終了」** を押して閉じてください（「デバッグ」は押さない）。
        2. 画面が動かなくなったり、おかしい場合は、Excelを一度閉じて（保存しますか？と聞かれたら「保存しない」を選択）、もう一度開き直してください。
    	3. それでも直らない場合は、システム担当（結城）へ連絡してください。
    </Accordion>

</Accordions>

---

## 🔧 管理者向け情報

<Accordions>
<Accordion title="日付設定のロジック">
    各シートの日付セルには `=TODAY() + [参照セル]` という数式が入力されています。\
    「明日」ボタン等のマクロは、この **参照セル（オフセット値）** を書き換えることで日付を制御しています。

    - **夜間用 (F1 セル):** `""` (当日)
    - **その他 (I1, E1 セル):** `1` (翌日)

</Accordion>
<Accordion title="印刷マクロの仕様">
  ボタンに割り当てられているマクロは `PrintFourSheets` です。\
  以下の 5 つのシートを順番に `ws.PrintOut` メソッドで出力します。

1. 夜間用
2. 昼間用
3. 焼成後チェック
4. 伝票用
5. クリエ伝票用

`ws.PrintOut` はシートの印刷範囲全体を出力するため、行数が増えて改ページが発生した場合、自動的に複数枚が出力されます。

</Accordion>
</Accordions>

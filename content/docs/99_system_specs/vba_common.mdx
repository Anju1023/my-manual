---
title: 'å…±é€šé–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹'
description: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å…±é€šé–¢æ•°ã‚„ã€å•†å“ã‚¯ãƒ©ã‚¹ (ClsItem) ã®ä»•æ§˜è§£èª¬ã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';
import {
	FileCode,
	Box,
	Variable,
	FunctionSquare,
	AlertTriangle,
} from 'lucide-react';

# ğŸ§© å…±é€šé–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§å…±æœ‰ã•ã‚Œã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹å®šç¾©ã¨ã€æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾¿åˆ©é–¢æ•°ç¾¤ã§ã™ã€‚
ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚„è¨ˆç®—å‡¦ç†ã¯ã€ã“ã‚Œã‚‰ã®å…±é€šéƒ¨å“ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

<Callout type="warn" title="é–‹ç™ºç’°å¢ƒã®æ³¨æ„ç‚¹" icon={<AlertTriangle />}>
	æœ¬ã‚·ã‚¹ãƒ†ãƒ ã®VBAã¯ **`Scripting.Dictionary`** ã‚’å¤šç”¨ã—ã¦ã„ã¾ã™ã€‚
	VBAã‚¨ãƒ‡ã‚£ã‚¿ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ `ãƒ„ãƒ¼ãƒ«` > `å‚ç…§è¨­å®š` ã‚’é–‹ãã€**ã€ŒMicrosoft
	Scripting Runtimeã€** ã«ãƒã‚§ãƒƒã‚¯ãŒå…¥ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
</Callout>

## ğŸ“¦ ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### `ClsItem` (å•†å“ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)

å•†å“ãƒã‚¹ã‚¿ã® 1 è¡Œåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
`LoadItemDictionary` é–¢æ•°ã«ã‚ˆã‚Šã€å…¨å•†å“ãŒã“ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦ãƒ¡ãƒ¢ãƒªã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚

#### ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å         | å‹     | èª¬æ˜                                      |
| :------------------- | :----- | :---------------------------------------- |
| `ItemID`, `ItemName` | String | å•†å“ ID, å•†å“å                           |
| `Price`, `Price2`    | Long   | å£²ä¾¡ (ãƒ­ãƒ¼ã‚¼ãƒ³), ã‚¯ãƒªã‚¨å£²ä¾¡               |
| `Frozen`             | String | å†·ç”Ÿåœ°åŒºåˆ† (`ã€‡`: å†·å‡ / `Ã—`: ã‚¹ã‚¯ãƒ©ãƒƒãƒ) |
| `FrozenDaysBefore`   | Long   | ç”Ÿåœ°å‡ºã—æ—¥æ•° (ç´å“æ—¥ã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ)     |
| `QtyPerUnit`         | Double | ç”Ÿåœ°æ•° (1 å˜ä½ã‚ãŸã‚Šã®ç‰æ•°)               |
| `UnitCount`          | Double | ä½•å€‹å…¥ (1 è¢‹ã‚ãŸã‚Šã®å€‹æ•°)                 |

<Accordions>
<Accordion title="ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ (ClsItem)" icon={<FileCode />}>
```vb
Option Explicit
Public ItemID As String 'å•†å“ID
Public ItemName As String 'å•†å“å
Public Price As Double 'å£²ä¾¡
Public Price2 As Double 'ã‚¯ãƒªã‚¨å£²ä¾¡
Public Label As Long 'ãƒ©ãƒ™ãƒ«ç•ªå·
Public Label2 As Long 'ã‚¯ãƒªã‚¨ãƒ©ãƒ™ãƒ«
Public Finder As Long 'é‡‘æ¢ç•ªå·
Public Expiry As Long 'æ¶ˆè²»æœŸé™
Public Dough As String 'ç”Ÿåœ°å
Public Frozen As String 'å†·ç”Ÿåœ°è¡¨
Public Display As String 'ä¸¦ã¹ã‚‹è¡¨ã€‡
Public FrozenDaysBefore As Long 'ç”Ÿåœ°å‡ºã—ã®æ—¥
Public DisplayDays As Long 'ä¸¦ã¹ã‚‹æ—¥
Public QtyPerUnit As Double 'ç”Ÿåœ°æ•°
Public UnitCount As Double 'ä½•å€‹å…¥
Public maxQty As Long 'æœ€å¤§æ•°
Public Multiple As Double 'å€æ•°
Public Bag As String 'è¢‹ã®ç¨®é¡
Public Finish As String 'çµ‚å£²

' ç”Ÿåœ°å‡ºã—æ•°ã®è¨ˆç®—
Public Function OutputQty(ByVal count As Double) As Long
If UnitCount = 0 Then UnitCount = 1
If QtyPerUnit = 0 Then QtyPerUnit = 1
OutputQty = WorksheetFunction.RoundUp(count _ UnitCount _ QtyPerUnit, 0)
End Function

' ä¸¦ã¹ã‚‹æ•°ã®è¨ˆç®—
Public Function DisplayQty(ByVal count As Double) As Long
If UnitCount = 0 Then UnitCount = 1
DisplayQty = WorksheetFunction.RoundUp(count \* UnitCount, 0)
End Function

````
</Accordion>
</Accordions>

### `ClsLabel` (ãƒ©ãƒ™ãƒ«é›†è¨ˆç”¨)

ãƒ©ãƒ™ãƒ«å‡ºã—è¡¨ã®ä½œæˆæ™‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ä¸€æ™‚çš„ãªã‚¯ãƒ©ã‚¹ã§ã™ã€‚
æ›œæ—¥ã”ã¨ã®æ•°é‡ã¨ã€è¨ˆç®—ã•ã‚ŒãŸæ¶ˆè²»æœŸé™ã‚’ä¿æŒã—ã¾ã™ã€‚

---

## ğŸ› ï¸ å…±é€šé–¢æ•° (æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)

### ğŸ“š è¾æ›¸ãƒ­ãƒ¼ãƒ‰ç³»

Excel ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€æ¤œç´¢ã—ã‚„ã™ã„å½¢ï¼ˆDictionaryï¼‰ã«å¤‰æ›ã—ã¦è¿”ã—ã¾ã™ã€‚

<Accordions>
<Accordion title="LoadItemDictionary / LoadStoreDictionary" icon={<FileCode />}>
```vb
Public Function LoadItemDictionary() As Object
    Dim dic As Object, wb As Workbook, ws As Worksheet, tbl As ListObject
    Set dic = CreateObject("Scripting.Dictionary")
    ' ... (ä¸­ç•¥: å•†å“ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ«ãƒ¼ãƒ—ã—ã¦ClsItemã«æ ¼ç´)
    Set LoadItemDictionary = dic
End Function

Public Function LoadStoreDictionary() As Object
    ' åº—èˆ—ãƒã‚¹ã‚¿ãƒ¼ã‚’èª­ã¿è¾¼ã¿ã€åº—èˆ—åã¨IDã®å¯¾å¿œè¡¨ã‚’ä½œæˆ
    ' ...
End Function
````

</Accordion>
</Accordions>

### ğŸ§® æ–‡å­—åˆ—ãƒ»è¨ˆç®—å‡¦ç†

ã‚ˆãä½¿ã†æ±ç”¨é–¢æ•°ã§ã™ã€‚

- **`Nz(value, [default])`**
  - å€¤ãŒ `Null`, `Empty`, ç©ºæ–‡å­—ã®å ´åˆã« 0 (ã¾ãŸã¯æŒ‡å®šå€¤) ã‚’è¿”ã—ã¾ã™ã€‚
  - è¨ˆç®—æ™‚ã®å‹ã‚¨ãƒ©ãƒ¼é˜²æ­¢ã«ä½¿ç”¨ã—ã¾ã™ã€‚
- **`GetBaseName(fullName)`**
  - å•†å“åã‹ã‚‰ã‚µã‚¤ã‚ºè¡¨è¨˜ï¼ˆã€Œ1/2ã€ã€Œ1 æœ¬ã€ç­‰ï¼‰ã‚’å‰Šé™¤ã—ã€**è¦ªåç§°** ã‚’è¿”ã—ã¾ã™ã€‚
- **`ToSafeSheetName(str)`**
  - ã‚·ãƒ¼ãƒˆåã«ä½¿ãˆãªã„æ–‡å­—ã‚’å…¨è§’ã«ç½®æ›ã—ã¾ã™ã€‚

<Accordions>
<Accordion title="ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ (ä¾¿åˆ©é–¢æ•°)" icon={<FileCode />}>
```vb
Public Function Nz(v, Optional defaultValue As Variant = 0)
    If IsError(v) Or IsEmpty(v) Or Trim(v & "") = "" Then
        Nz = defaultValue
    Else
        Nz = v
    End If
End Function

Function GetBaseName(ByVal fullName As String) As String
Dim temp As String
temp = Trim(fullName)
' ã‚µã‚¤ã‚ºè¡¨è¨˜ã‚’å‰Šé™¤ã—ã¦æ­£è¦åŒ–
temp = Replace(temp, " 1/2 æœ¬", "")
temp = Replace(temp, " 1/2", "")
' ... (ãã®ä»–ã®ç½®æ›)
GetBaseName = temp
End Function

````
</Accordion>
</Accordions>

### ğŸ å¤©æ¿è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯

ã€Œä¸¦ã¹ã‚‹è¡¨ã€ãªã©ã§ä½¿ç”¨ã•ã‚Œã‚‹ã€å¤©æ¿æšæ•°ã®è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã§ã™ã€‚
ãƒã‚¹ã‚¿ã® `æœ€å¤§æ•°(MaxQty)` ã¨ `å€æ•°(Multiple)` ã‚’ä½¿ç”¨ã—ã¦ã€æœ€ã‚‚åŠ¹ç‡çš„ãªä¸¦ã¹æ–¹ã‚’æ–‡å­—åˆ—ã§è¿”ã—ã¾ã™ã€‚

<Accordions>
<Accordion title="NarabeSingle (è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯)" icon={<FileCode />}>
```vb
Private Function NarabeSingle(dic As Object, panName As String, panQty As Long) As String
    ' ... (å•†å“ãƒã‚¹ã‚¿å–å¾—)

    ' ç·æ•°ã‚’å€æ•°ã§å‰²ã£ã¦ã€å¤©æ¿æšæ•°ã‚’è¨ˆç®—
    Dim a As Double, b As Double, c As Long
    a = panQty / proQty
    b = maxQty / proQty
    c = Application.RoundUp(a / b, 0)

    ' ... (è©³ç´°ãªæšæ•°é…åˆ†ãƒ­ã‚¸ãƒƒã‚¯)

    NarabeSingle = (b * proQty) & "Ã—" & e & "ã€" & ((b - 1) * proQty) & "Ã—" & d
End Function
````

</Accordion>
</Accordions>

---
title: 'Step 4: CBデータ登録'
description: 製造指示書を作成するためのマスターデータ (CB商品データ) に、新商品の情報を登録します。
---

import { Step, Steps } from 'fumadocs-ui/components/steps';
import { Callout } from 'fumadocs-ui/components/callout';
import { Files, File, Folder } from 'fumadocs-ui/components/files';
import {
	FileText,
	MousePointerClick,
	AlertTriangle,
	List,
	CheckCircle,
	Database,
	Keyboard,
	FileSpreadsheet,
	ClipboardList,
	Puzzle,
	Wrench,
} from 'lucide-react';

# <Database className='inline w-[1em] h-[1em] mr-1 -mt-1' /> CB 商品データの登録

製造指示書を作成するためのマスターデータ `CB商品データ.xlsm` に、新商品の情報を登録します。
専用の入力フォームを使用して、ミスなく登録を行います。

<Callout title="使用するファイル" icon={<FileText />}>
	**CB商品データ.xlsm**

    * **場所:** `デスクトップ` > `よく使う` > `商品データ` フォルダ内
    <Files>
    	<Folder name='デスクトップ' defaultOpen>
    		<Folder name='よく使う' defaultOpen>
    			<Folder name='Backup'>
    				<File name='CB商品データYYYY-MM-DD更新後.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD更新前.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD〇〇店変更.xlsm' icon={<FileSpreadsheet />} />
    				<File name='CB商品データYYYY-MM-DD更新後.xlsm' icon={<FileSpreadsheet />} />
    				...
    			</Folder>
    			<Folder name='商品データ' defaultOpen>
    				<Folder name='商品ごとの表'></Folder>
    				<File name='CB商品データ.xlsm' icon={<FileSpreadsheet />} />
    			</Folder>
    			<Folder name='伝票作成'>
    				<Folder name='納品記録'>
    					<Folder name='納品記録PDF'>
    						<Folder name='YYYY-MM'></Folder>
    						<Folder name='YYYY-MM'></Folder>
    					</Folder>
    				</Folder>
    				<File name='T納品データ.xlsm' icon={<FileSpreadsheet />} />
    			</Folder>
    			<File name='シフト表.xlsx' icon={<FileSpreadsheet />} />
    		</Folder>
    	</Folder>
    </Files>

</Callout>

## <ClipboardList className='inline w-[1em] h-[1em] mr-1 -mt-1' /> 登録手順

<Steps>
	<Step>

    	### フォームの起動

    	1. `CB商品データ.xlsm` を開きます。
    	2. 「操作」シートにある **「新規入力」** ボタンをクリックします。

    </Step>
    <Step>

    	### カテゴリの選択 (ID 自動発行)

    	フォームが開いたら、最初に **「カテゴリ」** をリストから選択してください。
    	選択と同時に、最新の番号が取得され、**商品 ID が自動的に入力されます。**

    	| カテゴリ   | ID 接頭辞 | 例    |
    	| :--------- | :-------: | :---- |
    	| 食パン     |   **S**   | S0123 |
    	| バケット   |   **B**   | B0123 |
    	| ロール     |   **R**   | R0123 |
    	| 菓子パン   |   **K**   | K0123 |
    	| 調理パン   |   **C**   | C0123 |
    	| ドーナツ   |   **D**   | D0123 |
    	| デニッシュ |   **E**   | E0123 |

    	<Callout type="error" title="IDは編集禁止！" icon={<AlertTriangle />}>
    		商品IDはシステムが自動で管理しています。
    		**手動で書き換えると重複エラーの原因になる** ため、絶対に触らないでください。
    	</Callout>

    </Step>
    <Step>

    	### 詳細情報の入力

    	各項目を入力していきます。

    	<Callout type="warn" title="入力モードに注意" icon={<Keyboard />}>
    		**数値や英数字は、必ず「半角」で入力してください。**
    		全角数字（例：`１００`）で入力すると、システムが数値として認識できず、計算結果が狂ったりエラーの原因になります。
    	</Callout>

    	**※クリエイトで販売しない商品** の場合、クリエイト用の項目は **空欄のまま** にしてください。

    	#### <Puzzle className='inline w-[1em] h-[1em] mr-1 -mt-1' /> 基本情報（価格・ラベル）

    	| 項目名           | 説明                       | 注意点                                                          |
    	| :--------------- | :------------------------- | :-------------------------------------------------------------- |
    	| **商品名**       | 商品の正式名称             | レシート名ではなく正式名で                                      |
    	| **売価**         | 店舗(ローゼン)での税抜売価 | **半角数字** で入力                                             |
    	| **クリエ売価**   | クリエイト納品時の税抜売価 | **販売しない場合は空欄**                                        |
    	| **ラベル**       | ラベラーの呼び出し番号     | [Step 3 で決めた番号](./03_labeler)                             |
    	| **クリエラベル** | クリエイト用の呼び出し番号 | **ローゼンとは異なる番号になります**<br/>(販売しない場合は空欄) |

    	#### <Puzzle className='inline w-[1em] h-[1em] mr-1 -mt-1' /> 製造・管理情報（リスト振分け）

    	どの製造リストに載せるかを決める重要な設定です。

    	| 項目名       | 設定値      | 意味                                     |
    	| :----------- | :---------- | :--------------------------------------- |
    	| **金探**     | 番号        | 金属探知機の設定番号                     |
    	| **期限**     | 日数        | 消費期限の日数                           |
    	| **生地名**   | 名称        | レシピに記載の生地名                     |
    	| **冷生地**   | `〇` / `×`  | `〇`: 冷凍生地出し表 / `×`: スクラッチ表 |
    	| **並べる表** | `〇` / 空欄 | `〇`: 並べる表に載せる                   |
    	| **生地出し** | 日数        | **納品日の何日前に** 生地出しするか      |
    	| **並べ**     | 日数        | **納品日の何日前に** 天板に並べるか      |

    	#### <Puzzle className='inline w-[1em] h-[1em] mr-1 -mt-1' /> 数量・規格（天板計算用）

    	「並べる表」で天板の枚数を計算するための係数です。

    	| 項目名     | 説明                                         |
    	| :--------- | :------------------------------------------- |
    	| **生地数** | 1 単位（1 個の商品）を作るのに必要な生地玉数 |
    	| **何個入** | 1 袋に入れる商品の個数                       |
    	| **最大数** | 天板 1 枚に乗せられる最大個数（Max 容量）    |
    	| **倍数**   | 天板に並べる時の単位（何個ずつ並べるか）     |
    	| **袋**     | 使用する袋の種類                             |
    	| **終売**   | (新商品の場合は空欄のまま)                   |

    </Step>
    <Step>

    	### 登録実行

    	入力内容に間違いがないか確認し、**「登録」** ボタンをクリックします。
    	「登録しました！」というメッセージが表示されたら完了です。

    </Step>

</Steps>

---

## <Wrench className='inline w-[1em] h-[1em] mr-1 -mt-1' /> 管理者向け情報

<Callout type="info" title="システム仕様 (VBA)" icon={<Database />}>
    #### ID自動生成ロジック (`cmbCategory_Change`)
    
    カテゴリが選択されると、既存データの最大値を取得し、接頭辞を付けて `+1` したIDをテキストボックスにセットします。

    #### 日付計算の仕組み

    「生地出し」や「並べ」に入力された日数は、`納品日 - 設定値` の計算に使われ、作業日を逆算して各リストに振り分けられます。

</Callout>

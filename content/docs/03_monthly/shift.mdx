---
title: シフト作成・清書
description: 翌月分のシフト表を作成し、スタッフへ共有する手順です。
---

import { Step, Steps } from 'fumadocs-ui/components/steps';
import { Callout } from 'fumadocs-ui/components/callout';
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';
import {
	FileText,
	Smartphone,
	Printer,
	Users,
	CalendarDays,
	AlertTriangle,
	Copy,
	Calculator,
	Image,
	CheckCircle,
} from 'lucide-react';

# 🗓️ シフト作成・清書

翌月分のパート・アルバイトスタッフのシフト表を作成します。
勤怠管理に関わる重要な書類ですので、正確な操作が必要です。

<Callout title="使用するファイル" icon={<FileText />}>
	**シフト表.xlsx** 
    
    * **場所:** `デスクトップ` > `よく使う` フォルダ内 
    * **フルパス:** `C:\Users\nanbu\OneDrive\Desktop\よく使う\シフト表.xlsx`

</Callout>

## 📋 操作手順

<Steps>
<Step>
 
### シートの準備（自動更新）

1. `シフト表.xlsx` を開きます。
2. **「今月分」のシート** を複製します。
3. シート名を **「翌月の数字のみ」** （例: `12` → `1`）に変更します。

<Callout type="success" title="自動で日付が変わります！">
	このファイルは、シート名に合わせて日付が自動更新される仕組みになっています。
</Callout>

<Callout type="error" title="12月の作業時は注意！" icon={<AlertTriangle />}>
	**翌年1月分** のシートを作る時（年越し）だけは、手動での修正が必要です。
	ページ下部の **[🎍 年末年始の特別作業](#-年末年始の特別作業重要)**
	を必ず確認してください。
</Callout>

</Step>
<Step>
 
### 日付範囲の調整 (11日〜10日)

給与締め日に合わせ、日付が **「11 日 〜 翌月 10 日」** になるように列を調整します。

- **列を削除する場合:** 不要な日の列を選択し、削除します。
- **列を増やす場合:**
  1. 隣の列を丸ごと選択して **コピー** します。
  2. そのまま右クリックし、**「コピーしたセルの挿入」** を選びます。
  3. 日付が重複するので、正しい日付のセルを 2 つ選択し、オートフィルして書き換えます。

</Step>
<Step>
 
### 年休残数の繰り越し

有給休暇（年休）の残数を新しい月に引き継ぎます。
月の日数によって列がズレることがあるため、**貼り付け場所（前月残）** をよく確認してください。

1. **「今月（複製元）」シート** の「年休残」列をコピーします。
2. **「翌月（新しい）」シート** の **AL5 セル付近 (前月残)** を選択し、**「値貼り付け (123)」** します。

![年休残数の貼り付け場所](https://placehold.co/600x400?text=Paste+Nenkyu+Here)

</Step>
<Step>
 
### 空白シートの印刷

1. シフト内容（`×` など）をすべて削除し、空白にします。
2. この状態で一度 **印刷** し、掲示します。

</Step>
<Step>
 
### シフト入力（清書）

部長から戻ってきた用紙を元に、Excel に入力します。

<Callout type="warn" title="半休の入力ルール" icon={<AlertTriangle />}>
	半日出勤の場合は、以下のいずれかの形式で入力してください。 
    
    * **「半」** という文字を含める（例: `有給(半休)`) 
    * **「AM」** または **「PM」** と入力する

</Callout>

</Step>
<Step>
 
### 印刷・共有

入力が終わったら、スタッフへ周知します。
細かい文字を鮮明に伝えるため、**PDF 経由** で画像を作成します。

1. **印刷:** 掲示用に 1 部印刷します。
2. **PDF 保存:** Excel の「エクスポート」等から **PDF 形式** で保存します。
3. **画像変換:** Web 上の変換ツール等を使い、PDF を **PNG 画像** に変換します。
4. **LINE 送信:** 変換した画像を、パートさんのグループ LINE に送信します。

</Step>
</Steps>

---

## ✅ 送信前の最終チェック

LINE で画像を送ってしまうと、訂正が大変です。
送信ボタンを押す前に、必ず以下のポイントを確認してください。

- [ ] **日付と曜日** は合っていますか？（カレンダーと照らし合わせましたか？）
- [ ] **年休残数** は正しく引き継がれていますか？
- [ ] **半休** の入力は正しいですか？（「0.5」と打っていませんか？）
- [ ] （1 月分の場合）**年（西暦）** の更新をしましたか？

---

## 🎍 年末年始の特別作業（重要）

年が変わるタイミング（12 月に翌年 1 月分を作る時）は、以下の修正が必要です。
これを忘れると **「曜日がズレる」「祝日が赤くならない」** という重大なミスに繋がります。

### 1. 「年」の手動更新

シート名を変えても「月」しか変わりません。「年」は手入力が必要です。

1. 新しい年のシート（シート名 `1`）を作成します。
2. 左上の **B1 セル (年)** を確認します。
3. ここを **新しい西暦 (例: 2026)** に手入力で書き換えてください。

![年の変更場所](https://placehold.co/600x400?text=Change+Year+Cell+B1)

### 2. 祝日リストの更新

祝日リストは常に最新の 2 年分で運用します。

1. **「祝日リスト」シート** を開きます。
2. 古い年のデータを削除し、**「今年」と「来年」の 2 年分** になるようにデータを入れ替えます。
3. **条件付き書式の確認:**
   - データが増えた場合、赤色にするルール（`COUNTIF`）の参照範囲が足りているか確認し、必要なら修正します。

---

## 🔧 管理者向け情報

<Accordions>
<Accordion title="日付自動表示の仕組み" icon={<Calculator />}>
    このシートは、シート名から「月」を取得する高度な数式を使用しています。

    - **月取得 (CELL 関数):**
    `=RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1)))`
    - ※シート名の数字（`1`〜`12`）を取得します。
    - **日付計算 (DATE 関数):**
    `=DATE($B$1, $D$1-1, 11)` \* ※`B1`セルの「年」と、取得した「月」を組み合わせて計算しています。

</Accordion>
<Accordion title="休日カウントのロジック" icon={<Calculator />}>
  休日日数の集計には以下の数式が使用されています。

```
=SUM(
    COUNTIF(C5:AG5,"×"),
    COUNTIF(C5:AG5,"年"),
    COUNTIF(C5:AG5,"／"),
    COUNTIF(C5:AG5,"健診"),
    COUNTIF(C5:AG5,"*半*")*0.5,
    COUNTIF(C5:AG5,"AM")*0.5,
    COUNTIF(C5:AG5,"PM")*0.5
)
```

</Accordion>
</Accordions>
